<!-- 

     HTML dropped by Zend Guard Compressor 4.2

     php.ru team: mz, az, yuri, vb, cyxapuk, 440hz, administrator
     2004-2007 (c) expi-web.com 
     2007-2008 (c) odware.com 
     0101-1010 (с) 440hz

     2b|~2b=?


-->

























































































<!-- EHOT тут всё пожрал ! -->






















<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="alternate" type="application/rss+xml" title="php.ru/forum - последние сообщения" href="http://www.php.ru/forum/rss.php">
<link rel="SHORTCUT ICON" href="http://www.php.ru/favicon.ico" />
<META name="description" content="php.ru - форум PHP программистов, поиск по всем ресурсам сети, посвященным php">
<meta http-equiv="description" content="php.ru - форум PHP программистов, поиск по всем ресурсам сети, посвященным php">
<META name="keywords" content="php, php5, apache, mysql, session">
<meta http-equiv="keywords" content="php, php5, apache, mysql, session">
<title>php.ru - Source Layout</title>
<LINK REL="stylesheet" TYPE="text/css" HREF="http://www.php.ru/index.css">
<script language="JavaScript" src="http://www.php.ru/ajax/ajax.js"></script>
</head>
<body>

<table height='100%' width='100%' cellspacing='0' cellpadding='0'>
  <tr height='99%' valign='top'>
    <td align='center'>
		
		<table style='margin-top: 4px' width=100% cellspacing=0 cellpadding=3>
   		<tr>
     		<td>PHP - <a href="http://ru.wikipedia.org/wiki/%D0%A0%D0%B5%D0%BA%D1%83%D1%80%D1%81%D0%B8%D0%B2%D0%BD%D1%8B%D0%B9_%D0%B0%D0%BA%D1%80%D0%BE%D0%BD%D0%B8%D0%BC" target=_blank class=lnk>рекурсивный акроним</a> словосочетания &laquo;<a href="/manual/introduction.html" class=lnk>PHP: Hypertext Preprocessor</a>&raquo;</td>
     	</tr>
   		</table>

		<script language="JavaScript" src="http://www.php.ru/ajax/subsys_ajax.js"></script>
		<!--

		commet by 440hz
		20.10.2007

		<script language="JavaScript" src="http://www.php.ru/ajax/pu_search.js"></script>

		-->

		<script language="JavaScript" src="http://www.php.ru/ajax/cz.js?a=b"></script>

		<table style='margin-top: 5px' width=100% bgcolor=#9999cc cellspacing=0 cellpadding=0 border=0>
   	 	<form name=SEARCH method=GET action="http://www.php.ru/search/?SID=b493x0elu33rpht6" onsubmit="return puSubmit();">
	  	<input type=hidden name=PAGE value=1>
  		<tr>
    		<td width='1' valign='middle'> 
    		   <a href='/'><img src="http://www.php.ru/;-)/logo.gif" width=133 height=93 alt="php" border=0 hspace=10 vspace=0></a>
			 </td>
		    <td width='100%' valign='middle'>
		       <!--
			   
				commet by 440hz
				20.10.2007

			   <div id='pu_search' class='pu_search'></div>
		       <div id='pu_search_description' class='pu_search_decription'></div>
			   
			   -->
        	 <input type=text style='width:99%; margin: 10px' maxlength='200' name='QS' class='in' id='query' autocomplete='off' value="" />
    		</td>
		  </tr>
   		<tr bgcolor='#666699' valign='middle'>
			<td style='border-top: 1px solid #333366;'><br /></td>
    		<td style='border-top: 1px solid #333366;'><div style="padding: 4px 4px 4px 10px; height: 24px; color: #CCCCFF;" id="stat">Хто там?<script>doLoadCZ('stat','stat');</script></div></td>
  		</tr>
		</form>
		</table>
		<table id="menu" cellspaciong=0 cellpadding=3>
<tr>
<td><a href="/" class=current>Главная</a></td>
<td><a href="/download/" class=current>Скачать</a></td>
<td><a href="/doc/" class=current>Документация</a></td>
<td><a href="/forum/" class=current>Форум</a></td>
<td width=100% align=right><a href="/phpinfo.html" class=current>phpinfo()</a></td>
</tr>
</table>

		
<!--  AdRiver code START. Type:728x90 Site: php.ru PZ: 0 BN: 1 -->
<script language="javascript" type="text/javascript"><!--
var RndNum4NoCash = Math.round(Math.random() * 1000000000);
var ar_Tail='unknown'; if (document.referrer) ar_Tail = escape(document.referrer);
document.write(
'<iframe src="http://ad.adriver.ru/cgi-bin/erle.cgi?'
+ 'sid=148680&bn=1&target=blank&bt=36&pz=0&rnd=' + RndNum4NoCash + '&tail256=' + ar_Tail
+ '" frameborder=0 vspace=0 hspace=0 width=728 height=90 marginwidth=0'
+ ' marginheight=0 scrolling=no></iframe>');
//--></script>
<noscript>
<a href="http://ad.adriver.ru/cgi-bin/click.cgi?sid=148680&bn=1&bt=36&pz=0&rnd=1525626915" target=_blank>
<img src="http://ad.adriver.ru/cgi-bin/rle.cgi?sid=148680&bn=1&bt=36&pz=0&rnd=1525626915" alt="-AdRiver-" border=0 width=728 height=90></a>
</noscript>
<!--  AdRiver code END  -->


  		<table width='100%' cellspacing='0' cellpadding='0'>
    		<tr valign='top'>
      		<td width=100%><div style="margin: 10px 10px 10px 50px;"><center><div style="width: 800px; text-align: left"><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>Руководство по PHP</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="zend.possibilities.html"
ACCESSKEY="P"
>Пред.</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Глава 46. Zend API: Hacking the Core of PHP</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="zend.build.html"
ACCESSKEY="N"
>След.</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="sect1"
><H1
CLASS="sect1"
><A
NAME="zend.layout"
>Source Layout</A
></H1
><DIV
CLASS="note"
><BLOCKQUOTE
CLASS="note"
><P
><B
>Замечание: </B
>
    Prior to working through the rest of this chapter, you should retrieve
    clean, unmodified source trees of your favorite Web server. We're working with
    Apache (available at 
    <A
HREF="http://www.apache.org/"
TARGET="_top"
>http://www.apache.org/</A
>)
    and, of course, with PHP (available at 
    <A
HREF="http://www.php.net/"
TARGET="_top"
>http://www.php.net/</A
> - does
    it need to be said?).
   </P
><P
>&#13;    Make sure that you can compile a working PHP environment by
    yourself! We won't go into this issue here, however, as you should
    already have this most basic ability when studying this chapter.
   </P
></BLOCKQUOTE
></DIV
><P
>&#13;   Before we start discussing code issues, you should familiarize
   yourself with the source tree to be able to quickly navigate
   through PHP's files. This is a must-have ability to implement and
   debug extensions.
  </P
><P
>&#13;   The following table describes the contents of the major directories.
  </P
><DIV
CLASS="informaltable"
><P
></P
><A
NAME="AEN206529"
></A
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL
WIDTH="1*"
TITLE="col1"><COL
WIDTH="3.74*"
TITLE="col2"><TBODY
><TR
><TD
>Directory</TD
><TD
>Contents</TD
></TR
><TR
><TD
><TT
CLASS="filename"
>php-src</TT
></TD
><TD
>&#13;       Main PHP source files and main header files; here you'll find
       all of PHP's API definitions, macros, etc. (important). 
       Everything else is below this directory.
      </TD
></TR
><TR
><TD
><TT
CLASS="filename"
>php-src/ext</TT
></TD
><TD
>&#13;       Repository for dynamic and built-in modules; by default, these
       are the "official" PHP modules that have been integrated into
       the main source tree. From PHP 4.0, it's possible to compile
       these standard extensions as dynamic loadable modules (at
       least, those that support it).
      </TD
></TR
><TR
><TD
><TT
CLASS="filename"
>php-src/main</TT
></TD
><TD
>&#13;       This directory contains the main php macros and definitions. (important)
      </TD
></TR
><TR
><TD
><TT
CLASS="filename"
>php-src/pear</TT
></TD
><TD
>&#13;       Directory for the PHP Extension and Application Repository. This directory contains
       core PEAR files.
      </TD
></TR
><TR
><TD
><TT
CLASS="filename"
>php-src/sapi</TT
></TD
><TD
>&#13;       Contains the code for the different server abstraction layers.
      </TD
></TR
><TR
><TD
><TT
CLASS="filename"
>TSRM</TT
></TD
><TD
>&#13;       Location of the "Thread Safe Resource Manager" (TSRM) for Zend
       and PHP.
      </TD
></TR
><TR
><TD
><TT
CLASS="filename"
>ZendEngine2</TT
></TD
><TD
>&#13;       Location of the Zend Engine files; here you'll
       find all of Zend's API definitions, macros, etc. (important).
      </TD
></TR
></TBODY
></TABLE
><P
></P
></DIV
><P
>&#13;   Discussing all the files included in the PHP package is beyond the
   scope of this chapter. However, you should take a close look at the
   following files:<P
></P
><UL
><LI
><P
>&#13;      <TT
CLASS="filename"
>php-src/main/php.h</TT
>, located in the main PHP directory.
      This file contains most of PHP's macro and API definitions.
     </P
></LI
><LI
><P
>&#13;      <TT
CLASS="filename"
>php-src/Zend/zend.h</TT
>, located in the main Zend directory.
      This file contains most of Zend's macros and definitions.
     </P
></LI
><LI
><P
>&#13;      <TT
CLASS="filename"
>php-src/Zend/zend_API.h</TT
>, also located in the Zend
      directory, which defines Zend's API.
     </P
></LI
></UL
> You should also follow some sub-inclusions from
   these files; for example, the ones relating to the Zend executor,
   the PHP initialization file support, and such. After reading these
   files, take the time to navigate around the package a little to see
   the interdependencies of all files and modules - how they relate to
   each other and especially how they make use of each other. This
   also helps you to adapt to the coding style in which PHP is
   authored. To extend PHP, you should quickly adapt to this style.
  </P
><DIV
CLASS="sect2"
><H2
CLASS="sect2"
><A
NAME="zend.layout.conventions"
>Extension Conventions</A
></H2
><P
>&#13;    Zend is built using certain conventions; to avoid breaking its
    standards, you should follow the rules described in the following
    sections.
   </P
></DIV
><DIV
CLASS="sect2"
><H2
CLASS="sect2"
><A
NAME="zend.layout.macros"
>Macros</A
></H2
><P
>&#13;    For almost every important task, Zend ships predefined macros that
    are extremely handy. The tables and figures in the following
    sections describe most of the basic functions, structures, and
    macros. The macro definitions can be found mainly in
    <TT
CLASS="filename"
>zend.h</TT
> and <TT
CLASS="filename"
>zend_API.h</TT
>.
    We suggest that you take a close look at these files after having
    studied this chapter. (Although you can go ahead and read them
    now, not everything will make sense to you yet.)
   </P
></DIV
><DIV
CLASS="sect2"
><H2
CLASS="sect2"
><A
NAME="zend.layout.memory-management"
>Memory Management</A
></H2
><P
>&#13;    Resource management is a crucial issue, especially in server
    software. One of the most valuable resources is memory, and memory
    management should be handled with extreme care. Memory management
    has been partially abstracted in Zend, and you should stick to
    this abstraction for obvious reasons: Due to the abstraction, Zend
    gets full control over all memory allocations. Zend is able to
    determine whether a block is in use, automatically freeing unused
    blocks and blocks with lost references, and thus prevent memory
    leaks. The functions to be used are described in the following
    table: 
    <DIV
CLASS="informaltable"
><P
></P
><A
NAME="AEN206587"
></A
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL
WIDTH="1*"
TITLE="col1"><COL
WIDTH="1.62*"
TITLE="col2"><TBODY
><TR
><TD
>Function</TD
><TD
>Description</TD
></TR
><TR
><TD
><B
CLASS="function"
>emalloc()</B
></TD
><TD
>Serves as replacement for
         <B
CLASS="function"
>malloc()</B
>.</TD
></TR
><TR
><TD
><B
CLASS="function"
>efree()</B
></TD
><TD
>Serves as replacement for
         <B
CLASS="function"
>free()</B
>.</TD
></TR
><TR
><TD
><B
CLASS="function"
>estrdup()</B
></TD
><TD
>Serves as replacement for
         <B
CLASS="function"
>strdup()</B
>.</TD
></TR
><TR
><TD
><A
HREF="zend-api.estrndup.html"
><B
CLASS="function"
>estrndup()</B
></A
></TD
><TD
>Serves as replacement for
         <B
CLASS="function"
>strndup()</B
>. Faster than
         <B
CLASS="function"
>estrdup()</B
> and binary-safe. This is the
         recommended function to use if you know the string length
         prior to duplicating it.</TD
></TR
><TR
><TD
><B
CLASS="function"
>ecalloc()</B
></TD
><TD
>Serves as replacement for
         <B
CLASS="function"
>calloc()</B
>.</TD
></TR
><TR
><TD
><B
CLASS="function"
>erealloc()</B
></TD
><TD
>Serves as replacement for
         <B
CLASS="function"
>realloc()</B
>.</TD
></TR
></TBODY
></TABLE
><P
></P
></DIV
> <B
CLASS="function"
>emalloc()</B
>,
    <B
CLASS="function"
>estrdup()</B
>,  <A
HREF="zend-api.estrndup.html"
><B
CLASS="function"
>estrndup()</B
></A
>,
    <B
CLASS="function"
>ecalloc()</B
>, and <B
CLASS="function"
>erealloc()</B
>
    allocate internal memory; <B
CLASS="function"
>efree()</B
> frees these
    previously allocated blocks. Memory handled by the
    <B
CLASS="function"
>e*()</B
> functions is considered local to the
    current process and is discarded as soon as the script executed by
    this process is terminated. 
    <DIV
CLASS="warning"
><P
></P
><TABLE
CLASS="warning"
BORDER="1"
WIDTH="100%"
><TR
><TD
ALIGN="CENTER"
><B
>Внимание</B
></TD
></TR
><TR
><TD
ALIGN="LEFT"
><P
>&#13;      To allocate resident memory that survives termination of
      the current script, you can use <B
CLASS="function"
>malloc()</B
> and
      <B
CLASS="function"
>free()</B
>. This should only be done with extreme
      care, however, and only in conjunction with demands of the Zend
      API; otherwise, you risk memory leaks.
     </P
></TD
></TR
></TABLE
></DIV
>
    Zend also features a thread-safe resource manager to
    provide better native support for multithreaded Web servers. This
    requires you to allocate local structures for all of your global
    variables to allow concurrent threads to be run. Because the
    thread-safe mode of Zend was not finished back when this was written, 
    it is not yet extensively covered here.
   </P
></DIV
><DIV
CLASS="sect2"
><H2
CLASS="sect2"
><A
NAME="zend.layout.dir-and-file"
>Directory and File Functions</A
></H2
><P
>&#13;    The following directory and file functions should be used in Zend
    modules. They behave exactly like their C counterparts, but
    provide virtual working directory support on the thread level. 
    <DIV
CLASS="informaltable"
><P
></P
><A
NAME="AEN206640"
></A
><TABLE
BORDER="1"
CLASS="CALSTABLE"
><COL
WIDTH="1*"
TITLE="col1"><COL
WIDTH="1*"
TITLE="col2"><TBODY
><TR
><TD
>Zend Function</TD
><TD
>Regular C Function</TD
></TR
><TR
><TD
><B
CLASS="function"
>V_GETCWD()</B
></TD
><TD
><B
CLASS="function"
>getcwd()</B
></TD
></TR
><TR
><TD
><B
CLASS="function"
>V_FOPEN()</B
></TD
><TD
><B
CLASS="function"
>fopen()</B
></TD
></TR
><TR
><TD
><B
CLASS="function"
>V_OPEN()</B
></TD
><TD
><B
CLASS="function"
>open()</B
></TD
></TR
><TR
><TD
><B
CLASS="function"
>V_CHDIR()</B
></TD
><TD
><B
CLASS="function"
>chdir()</B
></TD
></TR
><TR
><TD
><B
CLASS="function"
>V_GETWD()</B
></TD
><TD
><B
CLASS="function"
>getwd()</B
></TD
></TR
><TR
><TD
><B
CLASS="function"
>V_CHDIR_FILE()</B
></TD
><TD
>&#13;         Takes a file path as an argument and changes the current
         working directory to that file's directory.
        </TD
></TR
><TR
><TD
><B
CLASS="function"
>V_STAT()</B
></TD
><TD
><B
CLASS="function"
>stat()</B
></TD
></TR
><TR
><TD
><B
CLASS="function"
>V_LSTAT()</B
></TD
><TD
><B
CLASS="function"
>lstat()</B
></TD
></TR
></TBODY
></TABLE
><P
></P
></DIV
></P
></DIV
><DIV
CLASS="sect2"
><H2
CLASS="sect2"
><A
NAME="zend.layout.string-handling"
>String Handling</A
></H2
><P
>&#13;    Strings are handled a bit differently by the Zend engine
    than other values such as integers, Booleans, etc., which don't require
    additional memory allocation for storing their values. If you want to
    return a string from a function, introduce a new string variable to the symbol
    table, or do something similar, you have to make sure that the memory the
    string will be occupying has previously been allocated, using the
    aforementioned <B
CLASS="function"
>e*()</B
> functions for allocation. (This might
    not make much sense to you yet; just keep it somewhere in your head for now - we'll get
    back to it shortly.)
   </P
></DIV
><DIV
CLASS="sect2"
><H2
CLASS="sect2"
><A
NAME="zend.layout.complex-types"
>Complex Types</A
></H2
><P
>&#13;    Complex types such as arrays and objects require
    different treatment. Zend features a single API for these types - they're
    stored using hash tables.
   </P
><DIV
CLASS="note"
><BLOCKQUOTE
CLASS="note"
><P
><B
>Замечание: </B
>
     To reduce complexity in the following source examples, we're only
     working with simple types such as integers at first. A discussion about
     creating more advanced types follows later in this chapter.
    </P
></BLOCKQUOTE
></DIV
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="zend.possibilities.html"
ACCESSKEY="P"
>Пред.</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
ACCESSKEY="H"
>Начало</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="zend.build.html"
ACCESSKEY="N"
>След.</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Extension Possibilities</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="zend.html"
ACCESSKEY="U"
>Уровень выше</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>PHP's Automatic Build System</TD
></TR
></TABLE
></DIV
></div></center></div></td>
			<td><div style="display:none; width:200px;" id="o3" name="o3"><script charset="windows-1251" type="text/javascript" src="http://www.ozon.ru/PartnerTwinerNew.aspx?revident=bea9126b-c8e1-4bf5-b6d8-9a057f8feac6" ></script></div><script>o = document.getElementById('o3'); if(o) { var s = o.innerHTML; s = s.replace(/F6F6F6/gi,"FFFFFF"); o.innerHTML = s.replace(/padding-top: 10px; padding-bottom: 10px;/,"display:none;"); o.style.display = 'block'; } </script><br><div style="margin: 10px;"><script type="text/javascript"><!--
google_ad_client = "pub-4093271809023514";
/* 120x600, создано 01.11.2008 */
google_ad_slot = "0438855731";
google_ad_width = 120;
google_ad_height = 600;
//-->
</script>
<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script></div></td>
    		</tr>
  		</table>
    </td>
  </tr>
  <tr valign='bottom' height='1%'>
  <td>      <table width=100% cellspacing=0 cellpadding=5 border=0 bgcolor=#9999CC>
        <tr valign=center>
          <td class='phpcopyright' width='45%' align='left'>&nbsp;&nbsp;Engine <a  href="http://www.mnogosearch.org/">MnoGoSearch</a></td>
          <td class='phpcopyright' width='10%' align='center'>2007-2010 &copy <a  href="mailto:webmaster@php.ru">PHP.RU</a></td>
          <td class='phpcopyright' width='45%' align='right' >Powered by <a target="_blank" href="http://odware.ru">ODware</a> <a HREF="http://440hz.ru">440Hz</a> &nbsp;&nbsp;</td>
        </tr>
      </table>

    <div style="text-align: right; padding: 5px">
		<!--LiveInternet counter-->
		<script type="text/javascript">document.write('<a href="http://www.liveinternet.ru/click" target=_blank><img src="http://counter.yadro.ru/hit?t53.6;r' + escape(document.referrer) + ((typeof(screen)=='undefined')?'':';s'+screen.width+'*'+screen.height+'*'+(screen.colorDepth?screen.colorDepth:screen.pixelDepth)) + ';u' + escape(document.URL) +';i' + escape('Жж'+document.title.substring(0,80)) + ';' + Math.random() + '" border=0 width=88 height=31 alt="" title="LiveInternet: показано число просмотров и посетителей за 24 часа"><\/a>');
		</script>
		<!--/LiveInternet-->
		<!-- SpyLOG -->
		<script src="http://tools.spylog.ru/counter2.2.js" type="text/javascript" id="spylog_code" counter="830950" ></script>
		<noscript><a href="http://u8309.50.spylog.com/cnt?cid=830950&f=3&p=0" target="_blank"><img src="http://u8309.50.spylog.com/cnt?cid=830950&p=0&f=4" alt='SpyLOG' border='0' width=88 height=31 ></a>
		</noscript>
		<!--/ SpyLOG -->
	</div>
</td>
  </tr>
</table>

<script>
<!--
document.SEARCH.QS.focus();
// --></script>

<!-- 
	как же вы все это читаете?
	440hz 
-->

</body>
</html>